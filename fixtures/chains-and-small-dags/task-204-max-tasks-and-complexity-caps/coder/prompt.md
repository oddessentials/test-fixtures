You are the coder agent. Apply the architect and planner guidance to implement
the constrained refactoring of the legacy codebase.

Requirements:
- Implement only the constrained subset of tasks (max 3)
- Do not expand scope beyond what the planner outputs
- Focus on database.ts, api.ts, and utils.ts only
- Do not touch config.ts or logging.ts (out of scope due to constraints)

Return a unified diff patch that implements the constrained refactoring.
